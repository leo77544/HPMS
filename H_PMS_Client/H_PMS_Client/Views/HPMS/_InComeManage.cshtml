<div class="page-header">
    <h1>
        幸福里控制台
        <small>
            <i class="icon-double-angle-right"></i>
            查看
        </small>
    </h1>
</div><!-- /.page-header -->

<div class="row">
    <div class="col-xs-12">
        <!-- PAGE CONTENT BEGINS -->

        <div class="alert alert-block alert-success">
            <button type="button" class="close" data-dismiss="alert">
                <i class="icon-remove"></i>
            </button>

            <i class="icon-ok green"></i>

            <strong class="green">
                幸福里物业系统
                <small>(v1.0)</small>
            </strong>
            ,这里为您提供更更方便的物业管理。
        </div>
        <div class="alert alert-block alert-info">
            <p>
                <strong class="green">
                    数据统计
                </strong>
            </p>
            <p>
                <br />
                <span id="daycount" style="color:red; font-size: 22px;"></span>
                <br />
                <br />
                <span id="monthcount" style="color:blue; font-size: 26px;"></span>
                <br />
                <br />
                <span id="yearcount" style="color:black; font-size: 30px;"></span>
            </p>

        </div>
        <div class="alert alert-block alert-danger">
            <p>
                <strong class="green">
                    报表查询
                </strong>
            </p>

            <span>报表统计</span> <input id="times" type="text" onclick="WdatePicker()" />
            <input id="Button1" type="button" value="查询指定日期" onclick="searchDay()" />
            <input id="Button1" type="button" value="查询月份明细" onclick="searchMonth()" />
            <input id="Button1" type="button" value="查询年度明细" onclick="searchYear()" />
            <input id="Button1" type="button" value="查询年明细" onclick="searchYears()" />
            <br />
            <table class="table table-hover table-bordered table-hover tab-content table-condensed tab-pane" style="text-align:center;border:1px solid black;color:black;margin-top:15px;">
                <thead id="head" style="text-align:center;border:1px solid black;color:black">

                </thead>
                <tbody id="content" style="text-align:center;border:1px solid black;color:black"></tbody>


            </table>
            <div id="fto" style="text-align:center;width:100%">

            </div>

        </div>
        <div>

        </div>
        <!-- PAGE CONTENT ENDS -->
    </div><!-- /.col -->
</div><!-- /.row -->
<style>
    td {
        border: 1px solid #808080;
        vertical-align: middle;
        text-align: center;
        font-size: 18px;
        color: #676565;
    }

</style>
<script>
    //获取当前时间
    var da = new Date().getFullYear() + "-" + (new Date().getMonth() + 1) + "-" + new Date().getDate() + " " + new Date().getHours() + ":" + new Date().getMinutes() + ":" + new Date().getSeconds();
    //获取日统计
    DayCount(da);
    //获取月统计
    MonthCount(da);
    //获取年统计
    YearCount(da);
    //查询指定日期
    function searchDay() {
        if ($("#times").val() == "") {
            alert("请选择要查询的日期");
        }
        else {
            $.ajax({
                url: "/HPMS/GetDayRecord?str=" + $("#times").val(),
                dataType: "json",
                success: function (data) {
                    if (data == "[]") {
                        alert("当日无数据");
                    }
                    else {
                        var obj = JSON.parse(data);
                        var a = obj[0].sum;
                        if (a.toString().indexOf(".") == -1) {
                            $("#head").empty().append("<tr>"
                                + "<th style = 'text-align:center'> 年</th >"
                                + "<th style='text-align:center'>月</th>"
                                + "<th style='text-align:center'>日</th>"
                                + "<th style='text-align:center'>总计金额</th>"
                                + "</tr >");
                            $("#content").empty().append("<tr>"
                                + "<td style = 'text-align:center'>" + obj[0].year + "</td>"
                                + "<td style='text-align:center'>" + obj[0].month + "</td>"
                                + "<td style='text-align:center'>" + obj[0].day + "</td>"
                                + "<td style='text-align:center'>" + a + "</td>"
                                + "</tr >");
                        }
                        else {
                            var c = a.toString().substring(0, a.toString().indexOf(".") + 3);
                            $("#head").empty().append("<tr>"
                                + "<th style = 'text-align:center'> 年</th >"
                                + "<th style='text-align:center'>月</th>"
                                + "<th style='text-align:center'>日</th>"
                                + "<th style='text-align:center'>总计金额</th>"
                                + "</tr >");
                            $("#content").empty().append("<tr>"
                                + "<td style = 'text-align:center'>" + obj[0].year + "</td>"
                                + "<td style='text-align:center'>" + obj[0].month + "</td>"
                                + "<td style='text-align:center'>" + obj[0].day + "</td>"
                                + "<td style='text-align:center'>" + c + "</td>"
                                + "</tr >");
                        }
                    }
                }
            })
        }
    }
    //查询月份统计
    function searchMonth() {
        if ($("#times").val() == "") {
            alert("请选择要查询的日期");
        }
        else {
            $.ajax({
                url: "/HPMS/GetMonthdetail?str=" + $("#times").val(),
                dataType: "json",
                success: function (data) {
                    $("#content").empty();
                    if (data == "[]") {
                        alert("当日无数据");
                    }
                    else {
                        var obj = JSON.parse(data);
                        $(obj).each(function () {
                            var a = this.sum;
                            if (a.toString().indexOf(".") == -1) {
                                $("#head").empty().append("<tr>"
                                    + "<th style = 'text-align:center'> 年</th >"
                                    + "<th style='text-align:center'>月</th>"
                                    + "<th style='text-align:center'>日</th>"
                                    + "<th style='text-align:center'>总计金额</th>"
                                    + "</tr >");
                                $("#content").append("<tr>"
                                    + "<td style = 'text-align:center'>" + this.year + "</td>"
                                    + "<td style='text-align:center'>" + this.month + "</td>"
                                    + "<td style='text-align:center'>" + this.day + "</td>"
                                    + "<td style='text-align:center'>" + a + "</td>"
                                    + "</tr >");
                            }
                            else {
                                var c = a.toString().substring(0, a.toString().indexOf(".") + 3);
                                $("#head").empty().append("<tr>"
                                    + "<th style = 'text-align:center'> 年</th >"
                                    + "<th style='text-align:center'>月</th>"
                                    + "<th style='text-align:center'>日</th>"
                                    + "<th style='text-align:center'>总计金额</th>"
                                    + "</tr >");
                                $("#content").append("<tr>"
                                    + "<td style = 'text-align:center'>" + this.year + "</td>"
                                    + "<td style='text-align:center'>" + this.month + "</td>"
                                    + "<td style='text-align:center'>" + this.day + "</td>"
                                    + "<td style='text-align:center'>" + c + "</td>"
                                    + "</tr >");
                            }
                        })
                    }
                }
            })
        }
    }
    //查询年度统计
    function searchYear() {
        if ($("#times").val() == "") {
            alert("请选择要查询的日期");
        }
        else {
            $.ajax({
                url: "/HPMS/GetYeardetail?str=" + $("#times").val(),
                dataType: "json",
                success: function (data) {
                    $("#content").empty();
                    if (data == "[]") {
                        alert("当日无数据");
                    }
                    else {
                        var obj = JSON.parse(data);
                        $(obj).each(function () {
                            var a = this.sum;
                            if (a.toString().indexOf(".") == -1) {
                                $("#head").empty().append("<tr>"
                                    + "<th style = 'text-align:center'> 年</th >"
                                    + "<th style='text-align:center'>月</th>"
                                    + "<th style='text-align:center'>总计金额</th>"
                                    + "</tr >");
                                $("#content").append("<tr>"
                                    + "<td style = 'text-align:center'>" + this.year + "</td>"
                                    + "<td style='text-align:center'>" + this.month + "</td>"
                                    + "<td style='text-align:center'>" + a + "</td>"
                                    + "</tr >");
                            }
                            else {
                                var c = a.toString().substring(0, a.toString().indexOf(".") + 3);
                                $("#head").empty().append("<tr>"
                                    + "<th style = 'text-align:center'> 年</th >"
                                    + "<th style='text-align:center'>月</th>"
                                    + "<th style='text-align:center'>总计金额</th>"
                                    + "</tr >");
                                $("#content").append("<tr>"
                                    + "<td style = 'text-align:center'>" + this.year + "</td>"
                                    + "<td style='text-align:center'>" + this.month + "</td>"
                                    + "<td style='text-align:center'>" + c + "</td>"
                                    + "</tr >");
                            }
                        })
                    }
                }
            })
        }
    }
    //查询年份统计
    function searchYears() { 
        $.ajax({
            url: "/HPMS/GetYearsdetail",
            dataType: "json",
            success: function (data) {
                $("#content").empty();
                {
                    var obj = JSON.parse(data);
                    $(obj).each(function () {
                        var a = this.sum;
                        if (a.toString().indexOf(".") == -1) {
                            $("#head").empty().append("<tr>"
                                + "<th style = 'text-align:center'> 年</th >"
                                + "<th style='text-align:center'>总计金额</th>"
                                + "</tr >");
                            $("#content").append("<tr>"
                                + "<td style = 'text-align:center'>" + this.year + "</td>"
                                + "<td style='text-align:center'>" + a + "</td>"
                                + "</tr >");
                        }
                        else {
                            var c = a.toString().substring(0, a.toString().indexOf(".") + 3);
                            $("#head").empty().append("<tr>"
                                + "<th style = 'text-align:center'> 年</th >"
                                + "<th style='text-align:center'>总计金额</th>"
                                + "</tr >");
                            $("#content").append("<tr>"
                                + "<td style = 'text-align:center'>" + this.year + "</td>"
                                + "<td style='text-align:center'>" + c + "</td>"
                                + "</tr >");
                        }
                    })
                }
            }
        })
    }
    //获取日统计
    function DayCount(da) {
        $.ajax({
            url: "/HPMS/GetDayRecord?str=" + da,
            dataType: "json",
            success: function (data) {
                if (data == "[]") {
                    $("#daycount").text("截止当前时间" + new Date().getFullYear() + "年" + (new Date().getMonth() + 1) + "月" + new Date().getDate() + "日收入0.00元");
                }
                else {
                    var obj = JSON.parse(data);
                    var a = obj[0].sum;
                    if (a.toString().indexOf(".") == -1) {
                        $("#daycount").text("截止当前时间" + obj[0].year + "年" + obj[0].month + "月" + obj[0].day + "日收入" + a + "元");
                    }
                    else {
                        var c = a.toString().substring(0, a.toString().indexOf(".") + 3);
                        $("#daycount").text("截止当前时间" + obj[0].year + "年" + obj[0].month + "月" + obj[0].day + "日收入" + c + "元");
                    }
                }
            }
        })
    }
    //获取月统计
    function MonthCount(da) {
        $.ajax({
            url: "/HPMS/GetMonthRecord?str=" + da,
            dataType: "json",
            success: function (data) {
                var obj = JSON.parse(data);
                var a = obj[0].sum;
                var c = a.toString().substring(0, a.toString().indexOf(".") + 3);
                if (data == "[]") {
                    $("#monthcount").text("截止今日" + new Date().getFullYear() + "年" + (new Date().getMonth() + 1) + "月收入0.00元");
                }
                else {
                    if (a.toString().indexOf(".") == -1) {
                        $("#monthcount").text("截止今日" + obj[0].year + "年" + obj[0].month + "月收入" + a + "元");

                    }
                    else {
                        $("#monthcount").text("截止今日" + obj[0].year + "年" + obj[0].month + "月收入" + c + "元");
                    }
                }
            }
        })
    }
    //获取年统计
    function YearCount(da) {
        $.ajax({
            url: "/HPMS/GetYearRecord?str=" + da,
            dataType: "json",
            success: function (data) {
                //alert(data);
                var obj = JSON.parse(data);
                var a = obj[0].sum;
                var c = a.toString().substring(0, a.toString().indexOf(".") + 3);
                if (data == "[]") {
                    $("#yearcount").text("截止今日" + new Date().getFullYear() + "收入0.00元");
                }
                else {
                    if (a.toString().indexOf(".") == -1) {
                        $("#yearcount").text("截止今日" + obj[0].year + "年收入" + a + "元");

                    }
                    else {
                        $("#yearcount").text("截止今日" + obj[0].year + "年收入" + c + "元");
                    }
                }
            }
        })
    }
</script>
